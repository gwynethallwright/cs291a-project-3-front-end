(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(21)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(9),u=a.n(r),i=(a(15),a(7)),o=a(1),c=a(2),l=a(4),p=a(3),m=a(5),d=(a(16),a(6)),h=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={userList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"addWhiteSpace",value:function(e){return e<10?"0"+e.toString():e.toString()}},{key:"dateTimeString",value:function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+this.addWhiteSpace(t.getMonth()+1)+"-"+this.addWhiteSpace(this.addWhiteSpace(t.getDate()))+" "+("("+this.addWhiteSpace(t.getHours())+":"+this.addWhiteSpace(t.getMinutes())+":"+this.addWhiteSpace(t.getSeconds())+")")}},{key:"startStream",value:function(){var e=this,t=new EventSource("http://chat.cs291.com/stream/"+this.props.token);t.addEventListener("Disconnect",(function(a){console.log(e.props.token),t.close(),e.props.updateToken("")}),!1),t.addEventListener("ServerStatus",(function(t){e.props.updateMessageList([e.dateTimeString(JSON.parse(t.data).created)+" "+JSON.parse(t.data).status])}),!1),t.addEventListener("Join",(function(t){e.state.userList.push(JSON.parse(t.data).user),e.props.updateUserList(e.state.userList),e.props.updateMessageList([e.dateTimeString(JSON.parse(t.data).created)+" JOINED: "+JSON.parse(t.data).user])}),!1),t.addEventListener("Part",(function(t){var a=JSON.parse(t.data).user;e.state.userList=e.state.userList.filter((function(e){return e!==a})),e.props.updateUserList(e.state.userList),e.props.updateMessageList([e.dateTimeString(JSON.parse(t.data).created)+" PARTED: "+JSON.parse(t.data).user])}),!1),t.addEventListener("Message",(function(t){e.props.updateMessageList([e.dateTimeString(JSON.parse(t.data).created)+" "+JSON.parse(t.data).user+" : "+JSON.parse(t.data).message]),e.props.updateNumMessages()}),!1),t.addEventListener("Users",(function(t){e.state.userList=JSON.parse(t.data).users,e.props.updateUserList(e.state.userList)}),!1)}}]),t}(n.a.Component),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"sendRequest",value:function(){var e=this,t=new XMLHttpRequest,a=new FormData;a.append("password",this.props.password),a.append("username",this.props.username),t.open("POST","http://chat.cs291.com/login"),t.onreadystatechange=function(){if(console.log(t),4===t.readyState)if(201===t.status){var a=JSON.parse(t.responseText).token;e.props.updateToken(a),new h({token:a,updateToken:e.props.updateToken,updateMessageList:e.props.updateMessageList,updateUserList:e.props.updateUserList,updateNumMessages:e.props.updateNumMessages}).startStream()}else 403===t.status?alert("Invalid username or password"):alert(t.status+" failure to /login")},t.send(a)}}]),t}(n.a.Component),b=(a(17),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault(),new g({username:a.state.username,password:a.state.password,updateToken:a.props.updateToken,updateMessageList:a.props.updateMessageList,updateUserList:a.props.updateUserList,updateNumMessages:a.props.updateNumMessages}).sendRequest()},a.onChange=function(e){a.setState(Object(d.a)({},e.target.name,e.target.value))},a.state={username:"",password:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Halt: Who Goes There?"),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("form",{onSubmit:this.onSubmit},n.a.createElement("label",null," Username:",n.a.createElement("br",null),n.a.createElement("input",{name:"username",type:"text",value:this.state.username,onChange:this.onChange})),n.a.createElement("br",null),n.a.createElement("label",null," Password:",n.a.createElement("br",null),n.a.createElement("input",{name:"password",type:"password",value:this.state.password,onChange:this.onChange})),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("input",{type:"submit",value:"Login"})))}}]),t}(n.a.Component)),f=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"sendRequest",value:function(){var e=new FormData;e.append("message",this.props.message);var t=new XMLHttpRequest;t.open("POST","http://chat.cs291.com/message"),t.setRequestHeader("Authorization","Bearer "+this.props.token),t.send(e)}}]),t}(n.a.Component),O=(a(18),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault(),new f({message:a.state.message,token:a.props.token}).sendRequest(),a.setState({message:""})},a.onChange=function(e){a.setState(Object(d.a)({},e.target.name,e.target.value))},a.state={message:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("form",{onSubmit:this.onSubmit},n.a.createElement("input",{name:"message",type:"text",value:this.state.message,onChange:this.onChange})))}}]),t}(n.a.Component)),v=(a(19),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{class:"MessageListItem"},this.props.messageList.map((function(e,t){return n.a.createElement("p",null," ",e," ")}))))}}]),t}(n.a.Component)),E=(a(20),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{class:"UserListItem"},n.a.createElement("h3",null," ",n.a.createElement("u",null," Users Logged On: ")," "),n.a.createElement("br",null),this.props.userList.map((function(e,t){return n.a.createElement("p",null," ",e," ")}))))}}]),t}(n.a.Component)),L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).updateToken=function(e){a.setState((function(t,a){return{token:e}}))},a.updateMessageList=function(e){a.setState((function(t,a){return{messageList:[].concat(Object(i.a)(t.messageList),[e])}}))},a.updateUserList=function(e){a.setState((function(t,a){return{userList:e}}))},a.updateNumMessages=function(){a.setState((function(e,t){return{numMessages:a.state.numMessages+1}}))},a.state={token:"",messageList:[],userList:[],numMessages:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.title="Homemade Chat Client"}},{key:"render",value:function(){var e;if(""!==this.state.token){var t=new Set(this.state.userList),a=Object(i.a)(t);e=n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),n.a.createElement("h1",null,"Welcome to our Homemade Chat Client!"),n.a.createElement("br",null),n.a.createElement("div",{class:"NumMessages"},"Number of Messages: ",this.state.numMessages),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{class:"TopDisplay"},n.a.createElement(v,{messageList:this.state.messageList}),n.a.createElement(E,{userList:a})),n.a.createElement("br",null),n.a.createElement(O,{token:this.state.token}))}else e=n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{class:"Centered"},n.a.createElement(b,{updateToken:this.updateToken,updateMessageList:this.updateMessageList,updateUserList:this.updateUserList,updateNumMessages:this.updateNumMessages})));return e}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(n.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[10,1,2]]]);
//# sourceMappingURL=main.83ed8730.chunk.js.map